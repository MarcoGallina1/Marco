<?xml version="1.0" encoding="utf-8"?>
<odoo>
    <data>
        <record id="paperformat_print_dispatch" model="report.paperformat">
            <field name="name">fl print dispatch</field>
            <field name="default" eval="False" />
            <field name="format">A4</field>
            <field name="page_height">0</field>
            <field name="page_width">0</field>
            <field name="orientation">Portrait</field>
            <field name="margin_top">45</field>
            <field name="margin_bottom">10</field>
            <field name="margin_left">10</field>
            <field name="margin_right">10</field>
            <field name="header_line" eval="True" />
            <field name="header_spacing">0</field>
            <field name="dpi">80</field>
        </record>
    </data>

    <record id="view_sale_order_kanban2" model="ir.ui.view">
        <field name="name">view_.sale.order.kanban2</field>
        <field name="model">sale.order</field>
        <field name="inherit_id" ref="fl_sales.view_sale_order_kanban"/>
        <field name="arch" type="xml">
            <xpath expr="//t/div/div[3]/div" position="after">
                <a type="object" name="print_dispatch">
                    <span>Print Dispatch</span>
                </a>
            </xpath>
        </field>
    </record>

    <report
        id="action_report_fl_dispatch"
        string="FL Dispatch Print"
        model="sale.order"
        report_type="qweb-pdf"
        name="fl_dispatch_print.report_dispatch"
        file="fl_dispatch_print.report_dispatch"
        menu="False"
        paperformat="fl_dispatch_print.paperformat_print_dispatch"/>
    />


    <template id="report_dispatch">
        <t t-foreach="docs" t-as="o">
            <t t-call="fl_dispatch_print.report_dispatch_one"/>
        </t>
    </template>

    <template id="report_dispatch_one">
        <t t-call="web.basic_layout">
            <div class="header">
                <div class="text-center">
                    <img t-attf-src="/web/binary/company_logo?company={{ res_company.id }}"/>
                </div>
            </div>
            <div class="page">
                <div>
                    <div style="text-align: center;">
                        <span t-field="o.name"/><br/>
                        <span t-field="o.partner_id.name"/><br/>
                        <span t-field="o.partner_id.ref"/><br/>
                    </div>
                </div>
                <table class="table table-sm">
                    <thead>
                        <tr>
                            <th><span>Producto</span></th>
                            <th><span>UN de Medida</span></th>
                            <th><span>Cantidad</span></th>
                        </tr>
                    </thead>
                    <tbody>
                        <t t-foreach="o.order_line" t-as="line">
                            <tr>
                                <td><span t-field="line.product_id.name"/></td>
                                <td><span t-field="line.product_uom.name"/></td>
                                <td><span t-field="line.product_uom_qty"/></td>
                            </tr>
                        </t>
                    </tbody>
                </table>
            </div>
        </t>
    </template>

</odoo>
